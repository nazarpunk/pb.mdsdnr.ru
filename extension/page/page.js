"use strict";
{
    while (true) {
        const $content = document.getElementById(`content`);
        if ($content === null)
            break;
        $content.removeAttribute(`id`);
    }
    window.isClientLogged = false;
    window.clientId = ``;
    const $user = document.querySelector(`.user.user-menu > .dropdown-toggle > .hidden-xs:last-child`);
    if ($user !== null) {
        window.clientId = $user.innerHTML;
        window.isClientLogged = window.clientId !== `Guest`;
    }
    const js = (path) => {
        const $js = document.createElement(`script`);
        $js.type = `text/javascript`;
        $js.src = `chrome-extension://${document.head.dataset.extensionId}${path}.js`;
        document.head.appendChild($js);
    };
    const css = (path) => {
        const $css = document.createElement(`link`);
        $css.rel = `stylesheet`;
        $css.href = `chrome-extension://${document.head.dataset.extensionId}${path}.css`;
        document.head.appendChild($css);
    };
    const source = (path) => {
        const root = `/page/${path}/${path}`;
        js(root);
        css(root);
        return path;
    };
    source(`all-sidebar`);
    source(`all-header`);
    const page = () => {
        const param = new URLSearchParams(window.location.search);
        const r = param.get('r');
        if (document.title.replace(/\s+/g, ``) === `-Error`)
            return source(`error`);
        if ((r === null || r === `user/login`) && document.querySelectorAll(`.login-box, .wrapper`).length === 2)
            return source(`login`);
        if (r === null)
            return ``;
        const split = r.replace(/^\//, ``).split(`/`);
        if (split.length !== 2)
            return ``;
        if (split[0] === `esvYear` && ['admin2', 'create2', 'update2', 'view2'].includes(split[1])) {
            split[0] += `2`;
            split[1] = split[1].replace(/2$/, ``);
        }
        document.body.dataset[`page`] = split[0];
        window.isSubpageCreate = split[1] === `create`;
        window.isSubpageUpdate = split[1] === `update`;
        if (['create', 'update'].includes(split[1])) {
            document.body.dataset[`subpageReal`] = split[1];
            split[1] = `edit`;
        }
        document.body.dataset[`subpage`] = split[1];
        let root = `/page/${split[0]}/${split[0]}-${split[1]}`;
        if ([`admin`, `edit`].includes(split[1]))
            source(`all-${split[1]}`);
        if ([`mykeys`, `viewsved`].includes(split[1]))
            source(`all-${split[1]}`);
        else {
            js(root);
            css(root);
        }
        return split[0];
    };
    window.pageName = page();
    document.querySelectorAll(`.span-3-5, .tabs, .tabcontents`).forEach($elem => $elem.removeAttribute(`style`));
    document.querySelectorAll(`.span-19 > div > br, [name=pageSize]`).forEach($elem => $elem.remove());
    document.querySelectorAll(`.skrolling`).forEach($elem => $elem.classList.remove(`skrolling`));
    document.querySelectorAll(`[action='index.php?r=${window.pageName}/index']`).forEach($form => $form.classList.add(`xml-upload-form`));
    const fuck30min = () => fetch(`${window.location.origin}/privcab/index.php?ajax=ppoot-grid&pageSize=100&r=pPOOt%2Fadmin`, { method: 'GET' });
    setInterval(fuck30min, 1000 * 60);
    fuck30min();
    js(`/page/_/tabs`);
    try {
        jQuery('#cru-dialog')[`dialog`]({
            title: 'Подписать',
            autoOpen: false,
            modal: true,
            width: 400,
            height: 600,
            close: () => window.location.reload()
        });
    }
    catch (e) { }
    const $login = document.querySelector(`.sidebar .info p`);
    const $name = document.querySelector(`.dropdown-menu .user-header p`);
    function update() {
        const extensionId = document.head.dataset.extensionId;
        chrome.runtime.sendMessage(extensionId, { updateData: true });
        if ($login !== null && $name !== null) {
            chrome.runtime.sendMessage(extensionId, {
                login: $login.innerText.trim(),
                updateClientName: $name.innerText.trim()
            });
        }
    }
    update();
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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S0FBSyxLQUFLLElBQUksRUFBRTtZQUN0QyxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxXQUFXLEVBQUU7Z0JBQ3ZDLEtBQUssRUFBYSxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRTtnQkFDekMsZ0JBQWdCLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUU7YUFDeEMsQ0FBQyxDQUFDO1NBQ0g7SUFDRixDQUFDO0lBRUQsTUFBTSxFQUFFLENBQUM7Q0FDVCIsImZpbGUiOiJleHRlbnNpb24vcGFnZS9wYWdlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cInBhZ2UuZC50c1wiIC8+XG57XG5cdC8vIGZpeCBjb250ZW50XG5cdHdoaWxlICh0cnVlKSB7XG5cdFx0Y29uc3QgJGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY29udGVudGApO1xuXHRcdGlmICgkY29udGVudCA9PT0gbnVsbCkgYnJlYWs7XG5cdFx0JGNvbnRlbnQucmVtb3ZlQXR0cmlidXRlKGBpZGApO1xuXHR9XG5cblx0Ly8gY2xpZW50XG5cdHdpbmRvdy5pc0NsaWVudExvZ2dlZCA9IGZhbHNlO1xuXHR3aW5kb3cuY2xpZW50SWQgPSBgYDtcblx0Y29uc3QgJHVzZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAudXNlci51c2VyLW1lbnUgPiAuZHJvcGRvd24tdG9nZ2xlID4gLmhpZGRlbi14czpsYXN0LWNoaWxkYCk7XG5cdGlmICgkdXNlciAhPT0gbnVsbCkge1xuXHRcdHdpbmRvdy5jbGllbnRJZCA9ICR1c2VyLmlubmVySFRNTDtcblx0XHR3aW5kb3cuaXNDbGllbnRMb2dnZWQgPSB3aW5kb3cuY2xpZW50SWQgIT09IGBHdWVzdGA7XG5cdH1cblxuXHRjb25zdCBqcyA9IChwYXRoOiBzdHJpbmcpID0+IHtcblx0XHRjb25zdCAkanMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBzY3JpcHRgKTtcblx0XHQkanMudHlwZSA9IGB0ZXh0L2phdmFzY3JpcHRgO1xuXHRcdCRqcy5zcmMgPSBgY2hyb21lLWV4dGVuc2lvbjovLyR7ZG9jdW1lbnQuaGVhZC5kYXRhc2V0LmV4dGVuc2lvbklkfSR7cGF0aH0uanNgO1xuXHRcdGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoJGpzKTtcblx0fTtcblxuXHRjb25zdCBjc3MgPSAocGF0aDogc3RyaW5nKSA9PiB7XG5cdFx0Y29uc3QgJGNzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYGxpbmtgKTtcblx0XHQkY3NzLnJlbCA9IGBzdHlsZXNoZWV0YDtcblx0XHQkY3NzLmhyZWYgPSBgY2hyb21lLWV4dGVuc2lvbjovLyR7ZG9jdW1lbnQuaGVhZC5kYXRhc2V0LmV4dGVuc2lvbklkfSR7cGF0aH0uY3NzYDtcblx0XHRkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKCRjc3MpO1xuXHR9O1xuXG5cdC8vIHNvdXJjZVxuXHRjb25zdCBzb3VyY2UgPSAocGF0aDogc3RyaW5nKSA9PiB7XG5cdFx0Y29uc3Qgcm9vdCA9IGAvcGFnZS8ke3BhdGh9LyR7cGF0aH1gO1xuXHRcdGpzKHJvb3QpO1xuXHRcdGNzcyhyb290KTtcblx0XHRyZXR1cm4gcGF0aDtcblx0fTtcblx0c291cmNlKGBhbGwtc2lkZWJhcmApO1xuXHRzb3VyY2UoYGFsbC1oZWFkZXJgKTtcblxuXG5cdC8vIHBhZ2Vcblx0Y29uc3QgcGFnZSA9ICgpOiBzdHJpbmcgPT4ge1xuXHRcdGNvbnN0IHBhcmFtID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcblx0XHRjb25zdCByID0gcGFyYW0uZ2V0KCdyJyk7XG5cblx0XHRpZiAoZG9jdW1lbnQudGl0bGUucmVwbGFjZSgvXFxzKy9nLCBgYCkgPT09IGAtRXJyb3JgKSByZXR1cm4gc291cmNlKGBlcnJvcmApO1xuXHRcdGlmICgociA9PT0gbnVsbCB8fCByID09PSBgdXNlci9sb2dpbmApICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5sb2dpbi1ib3gsIC53cmFwcGVyYCkubGVuZ3RoID09PSAyKSByZXR1cm4gc291cmNlKGBsb2dpbmApO1xuXHRcdGlmIChyID09PSBudWxsKSByZXR1cm4gYGA7XG5cblx0XHRjb25zdCBzcGxpdCA9IHIucmVwbGFjZSgvXlxcLy8sIGBgKS5zcGxpdChgL2ApO1xuXHRcdGlmIChzcGxpdC5sZW5ndGggIT09IDIpIHJldHVybiBgYDtcblxuXHRcdGlmIChzcGxpdFswXSA9PT0gYGVzdlllYXJgICYmIFsnYWRtaW4yJywgJ2NyZWF0ZTInLCAndXBkYXRlMicsICd2aWV3MiddLmluY2x1ZGVzKHNwbGl0WzFdKSkge1xuXHRcdFx0c3BsaXRbMF0gKz0gYDJgO1xuXHRcdFx0c3BsaXRbMV0gPSBzcGxpdFsxXS5yZXBsYWNlKC8yJC8sIGBgKTtcblx0XHR9XG5cdFx0ZG9jdW1lbnQuYm9keS5kYXRhc2V0W2BwYWdlYF0gPSBzcGxpdFswXTtcblxuXHRcdHdpbmRvdy5pc1N1YnBhZ2VDcmVhdGUgPSBzcGxpdFsxXSA9PT0gYGNyZWF0ZWA7XG5cdFx0d2luZG93LmlzU3VicGFnZVVwZGF0ZSA9IHNwbGl0WzFdID09PSBgdXBkYXRlYDtcblx0XHRpZiAoWydjcmVhdGUnLCAndXBkYXRlJ10uaW5jbHVkZXMoc3BsaXRbMV0pKSB7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmRhdGFzZXRbYHN1YnBhZ2VSZWFsYF0gPSBzcGxpdFsxXTtcblx0XHRcdHNwbGl0WzFdID0gYGVkaXRgO1xuXHRcdH1cblx0XHRkb2N1bWVudC5ib2R5LmRhdGFzZXRbYHN1YnBhZ2VgXSA9IHNwbGl0WzFdO1xuXG5cdFx0bGV0IHJvb3QgPSBgL3BhZ2UvJHtzcGxpdFswXX0vJHtzcGxpdFswXX0tJHtzcGxpdFsxXX1gO1xuXHRcdGlmIChbYGFkbWluYCwgYGVkaXRgXS5pbmNsdWRlcyhzcGxpdFsxXSkpIHNvdXJjZShgYWxsLSR7c3BsaXRbMV19YCk7XG5cdFx0aWYgKFtgbXlrZXlzYCwgYHZpZXdzdmVkYF0uaW5jbHVkZXMoc3BsaXRbMV0pKSBzb3VyY2UoYGFsbC0ke3NwbGl0WzFdfWApO1xuXHRcdGVsc2Uge1xuXHRcdFx0anMocm9vdCk7XG5cdFx0XHRjc3Mocm9vdCk7XG5cdFx0fVxuXHRcdHJldHVybiBzcGxpdFswXTtcblx0fTtcblxuXHR3aW5kb3cucGFnZU5hbWUgPSBwYWdlKCk7XG5cblx0Ly8gLS0tIGZpeFxuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuc3Bhbi0zLTUsIC50YWJzLCAudGFiY29udGVudHNgKS5mb3JFYWNoKCRlbGVtID0+ICRlbGVtLnJlbW92ZUF0dHJpYnV0ZShgc3R5bGVgKSk7XG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5zcGFuLTE5ID4gZGl2ID4gYnIsIFtuYW1lPXBhZ2VTaXplXWApLmZvckVhY2goJGVsZW0gPT4gJGVsZW0ucmVtb3ZlKCkpO1xuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuc2tyb2xsaW5nYCkuZm9yRWFjaCgkZWxlbSA9PiAkZWxlbS5jbGFzc0xpc3QucmVtb3ZlKGBza3JvbGxpbmdgKSk7XG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYFthY3Rpb249J2luZGV4LnBocD9yPSR7d2luZG93LnBhZ2VOYW1lfS9pbmRleCddYCkuZm9yRWFjaCgkZm9ybSA9PiAkZm9ybS5jbGFzc0xpc3QuYWRkKGB4bWwtdXBsb2FkLWZvcm1gKSk7XG5cblx0Ly8gYnJva2UgMzBtaW4gbGltaXRcblx0Y29uc3QgZnVjazMwbWluID0gKCkgPT4gZmV0Y2goYCR7d2luZG93LmxvY2F0aW9uLm9yaWdpbn0vcHJpdmNhYi9pbmRleC5waHA/YWpheD1wcG9vdC1ncmlkJnBhZ2VTaXplPTEwMCZyPXBQT090JTJGYWRtaW5gLCB7bWV0aG9kOiAnR0VUJ30pO1xuXHRzZXRJbnRlcnZhbChmdWNrMzBtaW4sIDEwMDAgKiA2MCk7XG5cdGZ1Y2szMG1pbigpO1xuXG5cdC8vIHRhYnNcblx0anMoYC9wYWdlL18vdGFic2ApO1xuXG5cdC8vIGpRdWVyeSBkaWFsb2cgZml4XG5cdHRyeSB7XG5cdFx0alF1ZXJ5KCcjY3J1LWRpYWxvZycpW2BkaWFsb2dgXSh7XG5cdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn0J/QvtC00L/QuNGB0LDRgtGMJyxcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b09wZW46IGZhbHNlLFxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbDogdHJ1ZSxcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDQwMCxcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA2MDAsXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlOiAoKSA9PiB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcblx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXHR9IGNhdGNoIChlKSB7fVxuXG5cdC8vIHVwZGF0ZVxuXHRjb25zdCAkbG9naW4gPSA8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnNpZGViYXIgLmluZm8gcGApO1xuXHRjb25zdCAkbmFtZSA9IDxIVE1MRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuZHJvcGRvd24tbWVudSAudXNlci1oZWFkZXIgcGApO1xuXG5cdGZ1bmN0aW9uIHVwZGF0ZSgpIHtcblx0XHRjb25zdCBleHRlbnNpb25JZCA9IDxzdHJpbmc+ZG9jdW1lbnQuaGVhZC5kYXRhc2V0LmV4dGVuc2lvbklkO1xuXHRcdGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKGV4dGVuc2lvbklkLCB7dXBkYXRlRGF0YTogdHJ1ZX0pO1xuXHRcdGlmICgkbG9naW4gIT09IG51bGwgJiYgJG5hbWUgIT09IG51bGwpIHtcblx0XHRcdGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKGV4dGVuc2lvbklkLCB7XG5cdFx0XHRcdGxvZ2luICAgICAgICAgICA6ICRsb2dpbi5pbm5lclRleHQudHJpbSgpLFxuXHRcdFx0XHR1cGRhdGVDbGllbnROYW1lOiAkbmFtZS5pbm5lclRleHQudHJpbSgpXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHR1cGRhdGUoKTtcbn1cbiJdfQ==
