"use strict";
{
    while (true) {
        const $content = document.getElementById(`content`);
        if ($content === null)
            break;
        $content.removeAttribute(`id`);
    }
    window.isClientLogged = false;
    window.clientId = ``;
    const $user = document.querySelector(`.user.user-menu > .dropdown-toggle > .hidden-xs:last-child`);
    if ($user !== null) {
        window.clientId = $user.innerHTML;
        window.isClientLogged = window.clientId !== `Guest`;
    }
    const js = (path) => {
        const $js = document.createElement(`script`);
        $js.type = `text/javascript`;
        $js.src = `chrome-extension://${document.head.dataset.extensionId}${path}.js`;
        document.head.appendChild($js);
    };
    const css = (path) => {
        const $css = document.createElement(`link`);
        $css.rel = `stylesheet`;
        $css.href = `chrome-extension://${document.head.dataset.extensionId}${path}.css`;
        document.head.appendChild($css);
    };
    const source = (path) => {
        const root = `/page/${path}/${path}`;
        js(root);
        css(root);
        return path;
    };
    source(`all-sidebar`);
    source(`all-header`);
    const page = () => {
        const param = new URLSearchParams(window.location.search);
        const r = param.get('r');
        if (document.title.replace(/\s+/g, ``) === `-Error`)
            return source(`error`);
        if ((r === null || r === `user/login`) && document.querySelectorAll(`.login-box, .wrapper`).length === 2)
            return source(`login`);
        if (r === null)
            return ``;
        const split = r.replace(/^\//, ``).split(`/`);
        if (split.length !== 2)
            return ``;
        if (split[0] === `esvYear` && ['admin2', 'create2', 'update2', 'view2'].includes(split[1])) {
            split[0] += `2`;
            split[1] = split[1].replace(/2$/, ``);
        }
        document.body.dataset[`page`] = split[0];
        window.isSubpageCreate = split[1] === `create`;
        window.isSubpageUpdate = split[1] === `update`;
        if (['create', 'update'].includes(split[1])) {
            document.body.dataset[`subpageReal`] = split[1];
            split[1] = `edit`;
        }
        document.body.dataset[`subpage`] = split[1];
        let root = `/page/${split[0]}/${split[0]}-${split[1]}`;
        if ([`admin`, `edit`].includes(split[1]))
            source(`all-${split[1]}`);
        if ([`mykeys`, `viewsved`].includes(split[1]))
            source(`all-${split[1]}`);
        else {
            js(root);
            css(root);
        }
        return split[0];
    };
    window.pageName = page();
    document.querySelectorAll(`.span-3-5, .tabs, .tabcontents`).forEach($elem => $elem.removeAttribute(`style`));
    document.querySelectorAll(`.span-19 > div > br, [name=pageSize]`).forEach($elem => $elem.remove());
    document.querySelectorAll(`.skrolling`).forEach($elem => $elem.classList.remove(`skrolling`));
    document.querySelectorAll(`[action='index.php?r=${window.pageName}/index']`).forEach($form => $form.classList.add(`xml-upload-form`));
    const fuck30min = () => fetch(`${window.location.origin}/privcab/index.php?ajax=ppoot-grid&pageSize=100&r=pPOOt%2Fadmin`, { method: 'GET' });
    setInterval(fuck30min, 1000 * 60);
    fuck30min();
    js(`/page/_/tabs`);
    try {
        jQuery('#cru-dialog')[`dialog`]({ title: 'Подписать', autoOpen: false, modal: true, width: 400, height: 600, close: () => window.location.reload() });
    }
    catch (e) { }
    const $login = document.querySelector(`.sidebar .info p`);
    const $name = document.querySelector(`.dropdown-menu .user-header p`);
    function update() {
        const extensionId = document.head.dataset.extensionId;
        chrome.runtime.sendMessage(extensionId, { updateData: true });
        if ($login !== null && $name !== null) {
            chrome.runtime.sendMessage(extensionId, { login: $login.innerText.trim(), updateClientName: $name.innerText.trim() });
        }
    }
    update();
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUFLLEtBQUssSUFBSSxFQUFFO1lBQ3RDLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxFQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxFQUFFLGdCQUFnQixFQUFFLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLEVBQUMsQ0FBQyxDQUFDO1NBQ3BIO0lBQ0YsQ0FBQztJQUNELE1BQU0sRUFBRSxDQUFDO0NBQ1QiLCJmaWxlIjoiZXh0ZW5zaW9uL3BhZ2UvcGFnZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJwYWdlLmQudHNcIiAvPlxyXG57XHJcblx0Ly8gZml4IGNvbnRlbnRcclxuXHR3aGlsZSAodHJ1ZSkge1xyXG5cdFx0Y29uc3QgJGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY29udGVudGApO1xyXG5cdFx0aWYgKCRjb250ZW50ID09PSBudWxsKSBicmVhaztcclxuXHRcdCRjb250ZW50LnJlbW92ZUF0dHJpYnV0ZShgaWRgKTtcclxuXHR9XHJcblx0XHJcblx0Ly8gY2xpZW50XHJcblx0d2luZG93LmlzQ2xpZW50TG9nZ2VkID0gZmFsc2U7XHJcblx0d2luZG93LmNsaWVudElkICAgICAgID0gYGA7XHJcblx0Y29uc3QgJHVzZXIgICAgICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnVzZXIudXNlci1tZW51ID4gLmRyb3Bkb3duLXRvZ2dsZSA+IC5oaWRkZW4teHM6bGFzdC1jaGlsZGApO1xyXG5cdGlmICgkdXNlciAhPT0gbnVsbCkge1xyXG5cdFx0d2luZG93LmNsaWVudElkICAgICAgID0gJHVzZXIuaW5uZXJIVE1MO1xyXG5cdFx0d2luZG93LmlzQ2xpZW50TG9nZ2VkID0gd2luZG93LmNsaWVudElkICE9PSBgR3Vlc3RgO1xyXG5cdH1cclxuXHRcclxuXHRjb25zdCBqcyA9IChwYXRoOiBzdHJpbmcpID0+IHtcclxuXHRcdGNvbnN0ICRqcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYHNjcmlwdGApO1xyXG5cdFx0JGpzLnR5cGUgID0gYHRleHQvamF2YXNjcmlwdGA7XHJcblx0XHQkanMuc3JjICAgPSBgY2hyb21lLWV4dGVuc2lvbjovLyR7ZG9jdW1lbnQuaGVhZC5kYXRhc2V0LmV4dGVuc2lvbklkfSR7cGF0aH0uanNgO1xyXG5cdFx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCgkanMpO1xyXG5cdH1cclxuXHRcclxuXHRjb25zdCBjc3MgPSAocGF0aDogc3RyaW5nKSA9PiB7XHJcblx0XHRjb25zdCAkY3NzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChgbGlua2ApO1xyXG5cdFx0JGNzcy5yZWwgICA9IGBzdHlsZXNoZWV0YDtcclxuXHRcdCRjc3MuaHJlZiAgPSBgY2hyb21lLWV4dGVuc2lvbjovLyR7ZG9jdW1lbnQuaGVhZC5kYXRhc2V0LmV4dGVuc2lvbklkfSR7cGF0aH0uY3NzYDtcclxuXHRcdGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoJGNzcyk7XHJcblx0fVxyXG5cdFxyXG5cdC8vIHNvdXJjZVxyXG5cdGNvbnN0IHNvdXJjZSA9IChwYXRoOiBzdHJpbmcpID0+IHtcclxuXHRcdGNvbnN0IHJvb3QgPSBgL3BhZ2UvJHtwYXRofS8ke3BhdGh9YDtcclxuXHRcdGpzKHJvb3QpO1xyXG5cdFx0Y3NzKHJvb3QpO1xyXG5cdFx0cmV0dXJuIHBhdGg7XHJcblx0fVxyXG5cdHNvdXJjZShgYWxsLXNpZGViYXJgKTtcclxuXHRzb3VyY2UoYGFsbC1oZWFkZXJgKTtcclxuXHRcclxuXHRcclxuXHQvLyBwYWdlXHJcblx0Y29uc3QgcGFnZSA9ICgpOiBzdHJpbmcgPT4ge1xyXG5cdFx0Y29uc3QgcGFyYW0gPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xyXG5cdFx0Y29uc3QgciAgICAgPSBwYXJhbS5nZXQoJ3InKTtcclxuXHRcdFxyXG5cdFx0aWYgKGRvY3VtZW50LnRpdGxlLnJlcGxhY2UoL1xccysvZywgYGApID09PSBgLUVycm9yYCkgcmV0dXJuIHNvdXJjZShgZXJyb3JgKTtcclxuXHRcdGlmICgociA9PT0gbnVsbCB8fCByID09PSBgdXNlci9sb2dpbmApICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5sb2dpbi1ib3gsIC53cmFwcGVyYCkubGVuZ3RoID09PSAyKSByZXR1cm4gc291cmNlKGBsb2dpbmApO1xyXG5cdFx0aWYgKHIgPT09IG51bGwpIHJldHVybiBgYDtcclxuXHRcdFxyXG5cdFx0Y29uc3Qgc3BsaXQgPSByLnJlcGxhY2UoL15cXC8vLCBgYCkuc3BsaXQoYC9gKTtcclxuXHRcdGlmIChzcGxpdC5sZW5ndGggIT09IDIpIHJldHVybiBgYDtcclxuXHRcdFxyXG5cdFx0aWYgKHNwbGl0WzBdID09PSBgZXN2WWVhcmAgJiYgWydhZG1pbjInLCAnY3JlYXRlMicsICd1cGRhdGUyJywgJ3ZpZXcyJ10uaW5jbHVkZXMoc3BsaXRbMV0pKSB7XHJcblx0XHRcdHNwbGl0WzBdICs9IGAyYDtcclxuXHRcdFx0c3BsaXRbMV0gPSBzcGxpdFsxXS5yZXBsYWNlKC8yJC8sIGBgKTtcclxuXHRcdH1cclxuXHRcdGRvY3VtZW50LmJvZHkuZGF0YXNldFtgcGFnZWBdID0gc3BsaXRbMF07XHJcblx0XHRcclxuXHRcdHdpbmRvdy5pc1N1YnBhZ2VDcmVhdGUgPSBzcGxpdFsxXSA9PT0gYGNyZWF0ZWA7XHJcblx0XHR3aW5kb3cuaXNTdWJwYWdlVXBkYXRlID0gc3BsaXRbMV0gPT09IGB1cGRhdGVgO1xyXG5cdFx0aWYgKFsnY3JlYXRlJywgJ3VwZGF0ZSddLmluY2x1ZGVzKHNwbGl0WzFdKSkge1xyXG5cdFx0XHRkb2N1bWVudC5ib2R5LmRhdGFzZXRbYHN1YnBhZ2VSZWFsYF0gPSBzcGxpdFsxXTtcclxuXHRcdFx0c3BsaXRbMV0gICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gYGVkaXRgO1xyXG5cdFx0fVxyXG5cdFx0ZG9jdW1lbnQuYm9keS5kYXRhc2V0W2BzdWJwYWdlYF0gPSBzcGxpdFsxXTtcclxuXHRcdFxyXG5cdFx0bGV0IHJvb3QgPSBgL3BhZ2UvJHtzcGxpdFswXX0vJHtzcGxpdFswXX0tJHtzcGxpdFsxXX1gO1xyXG5cdFx0aWYgKFtgYWRtaW5gLCBgZWRpdGBdLmluY2x1ZGVzKHNwbGl0WzFdKSkgc291cmNlKGBhbGwtJHtzcGxpdFsxXX1gKTtcclxuXHRcdGlmIChbYG15a2V5c2AsIGB2aWV3c3ZlZGBdLmluY2x1ZGVzKHNwbGl0WzFdKSkgc291cmNlKGBhbGwtJHtzcGxpdFsxXX1gKTtcclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRqcyhyb290KTtcclxuXHRcdFx0Y3NzKHJvb3QpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHNwbGl0WzBdO1xyXG5cdH1cclxuXHRcclxuXHR3aW5kb3cucGFnZU5hbWUgPSBwYWdlKCk7XHJcblx0XHJcblx0Ly8gLS0tIGZpeFxyXG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5zcGFuLTMtNSwgLnRhYnMsIC50YWJjb250ZW50c2ApLmZvckVhY2goJGVsZW0gPT4gJGVsZW0ucmVtb3ZlQXR0cmlidXRlKGBzdHlsZWApKTtcclxuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuc3Bhbi0xOSA+IGRpdiA+IGJyLCBbbmFtZT1wYWdlU2l6ZV1gKS5mb3JFYWNoKCRlbGVtID0+ICRlbGVtLnJlbW92ZSgpKTtcclxuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuc2tyb2xsaW5nYCkuZm9yRWFjaCgkZWxlbSA9PiAkZWxlbS5jbGFzc0xpc3QucmVtb3ZlKGBza3JvbGxpbmdgKSk7XHJcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2FjdGlvbj0naW5kZXgucGhwP3I9JHt3aW5kb3cucGFnZU5hbWV9L2luZGV4J11gKS5mb3JFYWNoKCRmb3JtID0+ICRmb3JtLmNsYXNzTGlzdC5hZGQoYHhtbC11cGxvYWQtZm9ybWApKTtcclxuXHRcclxuXHQvLyBicm9rZSAzMG1pbiBsaW1pdFxyXG5cdGNvbnN0IGZ1Y2szMG1pbiA9ICgpID0+IGZldGNoKGAke3dpbmRvdy5sb2NhdGlvbi5vcmlnaW59L3ByaXZjYWIvaW5kZXgucGhwP2FqYXg9cHBvb3QtZ3JpZCZwYWdlU2l6ZT0xMDAmcj1wUE9PdCUyRmFkbWluYCwge21ldGhvZDogJ0dFVCd9KTtcclxuXHRzZXRJbnRlcnZhbChmdWNrMzBtaW4sIDEwMDAgKiA2MCk7XHJcblx0ZnVjazMwbWluKCk7XHJcblx0XHJcblx0Ly8gdGFic1xyXG5cdGpzKGAvcGFnZS9fL3RhYnNgKTtcclxuXHRcclxuXHQvLyBqUXVlcnkgZGlhbG9nIGZpeFxyXG5cdHRyeSB7IGpRdWVyeSgnI2NydS1kaWFsb2cnKVtgZGlhbG9nYF0oe3RpdGxlOiAn0J/QvtC00L/QuNGB0LDRgtGMJywgYXV0b09wZW46IGZhbHNlLCBtb2RhbDogdHJ1ZSwgd2lkdGg6IDQwMCwgaGVpZ2h0OiA2MDAsIGNsb3NlOiAoKSA9PiB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCl9KX0gY2F0Y2ggKGUpIHt9XHJcblx0XHJcblx0Ly8gdXBkYXRlXHJcblx0Y29uc3QgJGxvZ2luID0gPEhUTUxFbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5zaWRlYmFyIC5pbmZvIHBgKTtcclxuXHRjb25zdCAkbmFtZSAgPSA8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmRyb3Bkb3duLW1lbnUgLnVzZXItaGVhZGVyIHBgKTtcclxuXHRmdW5jdGlvbiB1cGRhdGUoKSB7XHJcblx0XHRjb25zdCBleHRlbnNpb25JZCA9IDxzdHJpbmc+ZG9jdW1lbnQuaGVhZC5kYXRhc2V0LmV4dGVuc2lvbklkO1xyXG5cdFx0Y2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2UoZXh0ZW5zaW9uSWQsIHt1cGRhdGVEYXRhOiB0cnVlfSk7XHJcblx0XHRpZiAoJGxvZ2luICE9PSBudWxsICYmICRuYW1lICE9PSBudWxsKSB7XHJcblx0XHRcdGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKGV4dGVuc2lvbklkLCB7bG9naW46ICRsb2dpbi5pbm5lclRleHQudHJpbSgpLCB1cGRhdGVDbGllbnROYW1lOiAkbmFtZS5pbm5lclRleHQudHJpbSgpfSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdHVwZGF0ZSgpO1xyXG59Il19
