"use strict";
{
    while (true) {
        const $content = document.getElementById(`content`);
        if ($content === null)
            break;
        $content.removeAttribute(`id`);
    }
    window.isClientLogged = false;
    window.clientId = ``;
    const $user = document.querySelector(`.user.user-menu > .dropdown-toggle > .hidden-xs:last-child`);
    if ($user !== null) {
        window.clientId = $user.innerHTML;
        window.isClientLogged = window.clientId !== `Guest`;
    }
    const js = (path) => {
        let $js = document.createElement(`script`);
        $js.type = `text/javascript`;
        $js.src = `chrome-extension://${document.head.dataset.extensionId}${path}.js`;
        document.head.appendChild($js);
    };
    const css = (path) => {
        let $css = document.createElement(`link`);
        $css.rel = `stylesheet`;
        $css.href = `chrome-extension://${document.head.dataset.extensionId}${path}.css`;
        document.head.appendChild($css);
    };
    const source = (path) => {
        const root = `/page/${path}/${path}`;
        js(root);
        css(root);
        return path;
    };
    source(`all-sidebar`);
    source(`all-header`);
    const page = () => {
        const param = new URLSearchParams(window.location.search);
        const r = param.get('r');
        if (document.title.replace(/\s+/g, ``) === `-Error`)
            return source(`error`);
        if ((r === null || r === `user/login`) && document.querySelectorAll(`.login-box, .wrapper`).length === 2)
            return source(`login`);
        if (r === null)
            return ``;
        const split = r.replace(/^\//, ``).split(`/`);
        if (split.length !== 2)
            return ``;
        if (split[0] === `esvYear` && ['admin2', 'create2', 'update2', 'view2'].includes(split[1])) {
            split[0] += `2`;
            split[1] = split[1].replace(/2$/, ``);
        }
        document.body.dataset[`page`] = split[0];
        window.isSubpageCreate = split[1] === `create`;
        window.isSubpageUpdate = split[1] === `update`;
        if (['create', 'update'].includes(split[1])) {
            document.body.dataset[`subpageReal`] = split[1];
            split[1] = `edit`;
        }
        document.body.dataset[`subpage`] = split[1];
        let root = `/page/${split[0]}/${split[0]}-${split[1]}`;
        if ([`admin`, `edit`].includes(split[1]))
            source(`all-${split[1]}`);
        if ([`mykeys`, `viewsved`].includes(split[1]))
            source(`all-${split[1]}`);
        else {
            js(root);
            css(root);
        }
        return split[0];
    };
    window.pageName = page();
    document.querySelectorAll(`.span-3-5, .tabs, .tabcontents`).forEach($elem => $elem.removeAttribute(`style`));
    document.querySelectorAll(`.span-19 > div > br, [name=pageSize]`).forEach($elem => $elem.remove());
    document.querySelectorAll(`.skrolling`).forEach($elem => $elem.classList.remove(`skrolling`));
    document.querySelectorAll(`[action='index.php?r=${window.pageName}/index']`).forEach($form => $form.classList.add(`xml-upload-form`));
    const fuck30min = () => fetch(`${window.location.origin}/privcab/index.php?ajax=ppoot-grid&pageSize=100&r=pPOOt%2Fadmin`, { method: 'GET' });
    setInterval(fuck30min, 1000 * 60);
    fuck30min();
    js(`/page/_/tabs`);
    try {
        jQuery('#cru-dialog')[`dialog`]({ title: 'Подписать', autoOpen: false, modal: true, width: 400, height: 600, close: () => window.location.reload() });
    }
    catch (e) { }
    const $login = document.querySelector(`.sidebar .info p`);
    const $name = document.querySelector(`.dropdown-menu .user-header p`);
    function update() {
        const extensionId = document.head.dataset.extensionId;
        chrome.runtime.sendMessage(extensionId, { updateData: true });
        if ($login !== null && $name !== null) {
            chrome.runtime.sendMessage(extensionId, { login: $login.innerText.trim(), updateClientName: $name.innerText.trim() });
        }
    }
    update();
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4dGVuc2lvbi1vcGVyYS9leHRlbnNpb24vcGFnZS9wYWdlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQTtJQUVDLE9BQU8sSUFBSSxFQUFFO1FBQ1osTUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNwRCxJQUFJLFFBQVEsS0FBSyxJQUFJO1lBQUUsTUFBTTtRQUM3QixRQUFRLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQy9CO0lBR0QsTUFBTSxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUM7SUFDOUIsTUFBTSxDQUFDLFFBQVEsR0FBUyxFQUFFLENBQUM7SUFDM0IsTUFBTSxLQUFLLEdBQWEsUUFBUSxDQUFDLGFBQWEsQ0FBQyw0REFBNEQsQ0FBQyxDQUFDO0lBQzdHLElBQUksS0FBSyxLQUFLLElBQUksRUFBRTtRQUNuQixNQUFNLENBQUMsUUFBUSxHQUFTLEtBQUssQ0FBQyxTQUFTLENBQUM7UUFDeEMsTUFBTSxDQUFDLGNBQWMsR0FBRyxNQUFNLENBQUMsUUFBUSxLQUFLLE9BQU8sQ0FBQztLQUNwRDtJQUVELE1BQU0sRUFBRSxHQUFHLENBQUMsSUFBWSxFQUFFLEVBQUU7UUFDM0IsSUFBSSxHQUFHLEdBQUksUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM1QyxHQUFHLENBQUMsSUFBSSxHQUFHLGlCQUFpQixDQUFDO1FBQzdCLEdBQUcsQ0FBQyxHQUFHLEdBQUksc0JBQXNCLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsR0FBRyxJQUFJLEtBQUssQ0FBQztRQUMvRSxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNoQyxDQUFDLENBQUE7SUFFRCxNQUFNLEdBQUcsR0FBRyxDQUFDLElBQVksRUFBRSxFQUFFO1FBQzVCLElBQUksSUFBSSxHQUFJLFFBQVEsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFD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S0FBSyxJQUFJLElBQUksS0FBSyxLQUFLLElBQUksRUFBRTtZQUN0QyxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxXQUFXLEVBQUUsRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxnQkFBZ0IsRUFBRSxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxFQUFDLENBQUMsQ0FBQztTQUNwSDtJQUNGLENBQUM7SUFDRCxNQUFNLEVBQUUsQ0FBQztDQUNUIiwiZmlsZSI6ImV4dGVuc2lvbi1vcGVyYS9leHRlbnNpb24vcGFnZS9wYWdlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cInBhZ2UuZC50c1wiIC8+XHJcbntcclxuXHQvLyBmaXggY29udGVudFxyXG5cdHdoaWxlICh0cnVlKSB7XHJcblx0XHRjb25zdCAkY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjb250ZW50YCk7XHJcblx0XHRpZiAoJGNvbnRlbnQgPT09IG51bGwpIGJyZWFrO1xyXG5cdFx0JGNvbnRlbnQucmVtb3ZlQXR0cmlidXRlKGBpZGApO1xyXG5cdH1cclxuXHRcclxuXHQvLyBjbGllbnRcclxuXHR3aW5kb3cuaXNDbGllbnRMb2dnZWQgPSBmYWxzZTtcclxuXHR3aW5kb3cuY2xpZW50SWQgICAgICAgPSBgYDtcclxuXHRjb25zdCAkdXNlciAgICAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAudXNlci51c2VyLW1lbnUgPiAuZHJvcGRvd24tdG9nZ2xlID4gLmhpZGRlbi14czpsYXN0LWNoaWxkYCk7XHJcblx0aWYgKCR1c2VyICE9PSBudWxsKSB7XHJcblx0XHR3aW5kb3cuY2xpZW50SWQgICAgICAgPSAkdXNlci5pbm5lckhUTUw7XHJcblx0XHR3aW5kb3cuaXNDbGllbnRMb2dnZWQgPSB3aW5kb3cuY2xpZW50SWQgIT09IGBHdWVzdGA7XHJcblx0fVxyXG5cdFxyXG5cdGNvbnN0IGpzID0gKHBhdGg6IHN0cmluZykgPT4ge1xyXG5cdFx0bGV0ICRqcyAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGBzY3JpcHRgKTtcclxuXHRcdCRqcy50eXBlID0gYHRleHQvamF2YXNjcmlwdGA7XHJcblx0XHQkanMuc3JjICA9IGBjaHJvbWUtZXh0ZW5zaW9uOi8vJHtkb2N1bWVudC5oZWFkLmRhdGFzZXQuZXh0ZW5zaW9uSWR9JHtwYXRofS5qc2A7XHJcblx0XHRkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKCRqcyk7XHJcblx0fVxyXG5cdFxyXG5cdGNvbnN0IGNzcyA9IChwYXRoOiBzdHJpbmcpID0+IHtcclxuXHRcdGxldCAkY3NzICA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYGxpbmtgKTtcclxuXHRcdCRjc3MucmVsICA9IGBzdHlsZXNoZWV0YDtcclxuXHRcdCRjc3MuaHJlZiA9IGBjaHJvbWUtZXh0ZW5zaW9uOi8vJHtkb2N1bWVudC5oZWFkLmRhdGFzZXQuZXh0ZW5zaW9uSWR9JHtwYXRofS5jc3NgO1xyXG5cdFx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCgkY3NzKTtcclxuXHR9XHJcblx0XHJcblx0Ly8gc291cmNlXHJcblx0Y29uc3Qgc291cmNlID0gKHBhdGg6IHN0cmluZykgPT4ge1xyXG5cdFx0Y29uc3Qgcm9vdCA9IGAvcGFnZS8ke3BhdGh9LyR7cGF0aH1gO1xyXG5cdFx0anMocm9vdCk7XHJcblx0XHRjc3Mocm9vdCk7XHJcblx0XHRyZXR1cm4gcGF0aDtcclxuXHR9XHJcblx0c291cmNlKGBhbGwtc2lkZWJhcmApO1xyXG5cdHNvdXJjZShgYWxsLWhlYWRlcmApO1xyXG5cdFxyXG5cdFxyXG5cdC8vIHBhZ2VcclxuXHRjb25zdCBwYWdlID0gKCk6IHN0cmluZyA9PiB7XHJcblx0XHRjb25zdCBwYXJhbSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcblx0XHRjb25zdCByICAgICA9IHBhcmFtLmdldCgncicpO1xyXG5cdFx0XHJcblx0XHRpZiAoZG9jdW1lbnQudGl0bGUucmVwbGFjZSgvXFxzKy9nLCBgYCkgPT09IGAtRXJyb3JgKSByZXR1cm4gc291cmNlKGBlcnJvcmApO1xyXG5cdFx0aWYgKChyID09PSBudWxsIHx8IHIgPT09IGB1c2VyL2xvZ2luYCkgJiYgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLmxvZ2luLWJveCwgLndyYXBwZXJgKS5sZW5ndGggPT09IDIpIHJldHVybiBzb3VyY2UoYGxvZ2luYCk7XHJcblx0XHRpZiAociA9PT0gbnVsbCkgcmV0dXJuIGBgO1xyXG5cdFx0XHJcblx0XHRjb25zdCBzcGxpdCA9IHIucmVwbGFjZSgvXlxcLy8sIGBgKS5zcGxpdChgL2ApO1xyXG5cdFx0aWYgKHNwbGl0Lmxlbmd0aCAhPT0gMikgcmV0dXJuIGBgO1xyXG5cdFx0XHJcblx0XHRpZiAoc3BsaXRbMF0gPT09IGBlc3ZZZWFyYCAmJiBbJ2FkbWluMicsICdjcmVhdGUyJywgJ3VwZGF0ZTInLCAndmlldzInXS5pbmNsdWRlcyhzcGxpdFsxXSkpIHtcclxuXHRcdFx0c3BsaXRbMF0gKz0gYDJgO1xyXG5cdFx0XHRzcGxpdFsxXSA9IHNwbGl0WzFdLnJlcGxhY2UoLzIkLywgYGApO1xyXG5cdFx0fVxyXG5cdFx0ZG9jdW1lbnQuYm9keS5kYXRhc2V0W2BwYWdlYF0gPSBzcGxpdFswXTtcclxuXHRcdFxyXG5cdFx0d2luZG93LmlzU3VicGFnZUNyZWF0ZSA9IHNwbGl0WzFdID09PSBgY3JlYXRlYDtcclxuXHRcdHdpbmRvdy5pc1N1YnBhZ2VVcGRhdGUgPSBzcGxpdFsxXSA9PT0gYHVwZGF0ZWA7XHJcblx0XHRpZiAoWydjcmVhdGUnLCAndXBkYXRlJ10uaW5jbHVkZXMoc3BsaXRbMV0pKSB7XHJcblx0XHRcdGRvY3VtZW50LmJvZHkuZGF0YXNldFtgc3VicGFnZVJlYWxgXSA9IHNwbGl0WzFdO1xyXG5cdFx0XHRzcGxpdFsxXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBgZWRpdGA7XHJcblx0XHR9XHJcblx0XHRkb2N1bWVudC5ib2R5LmRhdGFzZXRbYHN1YnBhZ2VgXSA9IHNwbGl0WzFdO1xyXG5cdFx0XHJcblx0XHRsZXQgcm9vdCA9IGAvcGFnZS8ke3NwbGl0WzBdfS8ke3NwbGl0WzBdfS0ke3NwbGl0WzFdfWA7XHJcblx0XHRpZiAoW2BhZG1pbmAsIGBlZGl0YF0uaW5jbHVkZXMoc3BsaXRbMV0pKSBzb3VyY2UoYGFsbC0ke3NwbGl0WzFdfWApO1xyXG5cdFx0aWYgKFtgbXlrZXlzYCwgYHZpZXdzdmVkYF0uaW5jbHVkZXMoc3BsaXRbMV0pKSBzb3VyY2UoYGFsbC0ke3NwbGl0WzFdfWApO1xyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGpzKHJvb3QpO1xyXG5cdFx0XHRjc3Mocm9vdCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gc3BsaXRbMF07XHJcblx0fVxyXG5cdFxyXG5cdHdpbmRvdy5wYWdlTmFtZSA9IHBhZ2UoKTtcclxuXHRcclxuXHQvLyAtLS0gZml4XHJcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLnNwYW4tMy01LCAudGFicywgLnRhYmNvbnRlbnRzYCkuZm9yRWFjaCgkZWxlbSA9PiAkZWxlbS5yZW1vdmVBdHRyaWJ1dGUoYHN0eWxlYCkpO1xyXG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5zcGFuLTE5ID4gZGl2ID4gYnIsIFtuYW1lPXBhZ2VTaXplXWApLmZvckVhY2goJGVsZW0gPT4gJGVsZW0ucmVtb3ZlKCkpO1xyXG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5za3JvbGxpbmdgKS5mb3JFYWNoKCRlbGVtID0+ICRlbGVtLmNsYXNzTGlzdC5yZW1vdmUoYHNrcm9sbGluZ2ApKTtcclxuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbYWN0aW9uPSdpbmRleC5waHA/cj0ke3dpbmRvdy5wYWdlTmFtZX0vaW5kZXgnXWApLmZvckVhY2goJGZvcm0gPT4gJGZvcm0uY2xhc3NMaXN0LmFkZChgeG1sLXVwbG9hZC1mb3JtYCkpO1xyXG5cdFxyXG5cdC8vIGJyb2tlIDMwbWluIGxpbWl0XHJcblx0Y29uc3QgZnVjazMwbWluID0gKCkgPT4gZmV0Y2goYCR7d2luZG93LmxvY2F0aW9uLm9yaWdpbn0vcHJpdmNhYi9pbmRleC5waHA/YWpheD1wcG9vdC1ncmlkJnBhZ2VTaXplPTEwMCZyPXBQT090JTJGYWRtaW5gLCB7bWV0aG9kOiAnR0VUJ30pO1xyXG5cdHNldEludGVydmFsKGZ1Y2szMG1pbiwgMTAwMCAqIDYwKTtcclxuXHRmdWNrMzBtaW4oKTtcclxuXHRcclxuXHQvLyB0YWJzXHJcblx0anMoYC9wYWdlL18vdGFic2ApO1xyXG5cdFxyXG5cdC8vIGpRdWVyeSBkaWFsb2cgZml4XHJcblx0dHJ5IHsgalF1ZXJ5KCcjY3J1LWRpYWxvZycpW2BkaWFsb2dgXSh7dGl0bGU6ICfQn9C+0LTQv9C40YHQsNGC0YwnLCBhdXRvT3BlbjogZmFsc2UsIG1vZGFsOiB0cnVlLCB3aWR0aDogNDAwLCBoZWlnaHQ6IDYwMCwgY2xvc2U6ICgpID0+IHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKX0pfSBjYXRjaCAoZSkge31cclxuXHRcclxuXHQvLyB1cGRhdGVcclxuXHRjb25zdCAkbG9naW4gPSA8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnNpZGViYXIgLmluZm8gcGApO1xyXG5cdGNvbnN0ICRuYW1lICA9IDxIVE1MRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuZHJvcGRvd24tbWVudSAudXNlci1oZWFkZXIgcGApO1xyXG5cdGZ1bmN0aW9uIHVwZGF0ZSgpIHtcclxuXHRcdGNvbnN0IGV4dGVuc2lvbklkID0gPHN0cmluZz5kb2N1bWVudC5oZWFkLmRhdGFzZXQuZXh0ZW5zaW9uSWQ7XHJcblx0XHRjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZShleHRlbnNpb25JZCwge3VwZGF0ZURhdGE6IHRydWV9KTtcclxuXHRcdGlmICgkbG9naW4gIT09IG51bGwgJiYgJG5hbWUgIT09IG51bGwpIHtcclxuXHRcdFx0Y2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2UoZXh0ZW5zaW9uSWQsIHtsb2dpbjogJGxvZ2luLmlubmVyVGV4dC50cmltKCksIHVwZGF0ZUNsaWVudE5hbWU6ICRuYW1lLmlubmVyVGV4dC50cmltKCl9KTtcclxuXHRcdH1cclxuXHR9XHJcblx0dXBkYXRlKCk7XHJcbn0iXX0=
