"use strict";
document.title = `Вход`;
{
    const $wrapper = document.querySelector(`.wrapper`);
    const $loginBox = document.querySelector(`.login-box`);
    document.body.appendChild($loginBox);
    $wrapper.remove();
    const $submit = document.getElementById(`subm`);
    $submit.setAttribute(`class`, `btn btn-primary btn-block`);
    const $submitRow = $loginBox.querySelector(`.row.submit`);
    const $key = document.getElementById(`UserLogin_key`);
    $key.accept = `.key`;
    chrome.runtime.sendMessage(document.head.dataset.extensionId || ``, { getClients: true }, (data) => {
        if (data === null)
            return;
        $submitRow.insertAdjacentHTML('beforebegin', `<label class="switch-wrap"><div class="switch"><input type="checkbox" checked autocomplete="off" name="save"><div><span></span></div></div>Сохранить в моём профиле</label>`);
        const $form = document.getElementById(`login-form`);
        const $checkbox = $form.querySelector(`[type=checkbox]`);
        const { clients, token } = data;
        $form.addEventListener(`submit`, e => {
            if ($key.files.length == 0 || !$checkbox.checked)
                return;
            e.preventDefault();
            const formData = new FormData($form);
            fetch($form.action, { method: $form.method, body: formData })
                .then(response => {
                if (!response.redirected)
                    return $form.submit();
                const fileReader = new FileReader();
                fileReader.onload = e => {
                    const saveClient = {
                        token: token,
                        login: formData.get(`UserLogin[username]`),
                        password: formData.get(`UserLogin[password]`),
                        key: e.target.result
                    };
                    chrome.runtime.sendMessage(document.head.dataset.extensionId || ``, { saveClient: saveClient }, () => { return $form.submit(); });
                };
                fileReader.readAsText($key.files[0]);
            })
                .catch(() => $form.submit());
        });
        if (clients.length === 0)
            return;
        const $loginBoxBody = $loginBox.querySelector(`.login-box-body`);
        $loginBoxBody.insertAdjacentHTML('afterend', `<div class="login-box-body"><div class="form-group"><select id="login-client-select" class="form-control"></select></div><div class="row submit"><button id="login-client-btn" type="button" class="btn btn-primary btn-block">Войти</button></div></div>`);
        const $username = document.getElementById(`UserLogin_username`);
        const $password = document.getElementById(`UserLogin_password`);
        const $select = document.getElementById(`login-client-select`);
        const $submitClient = document.getElementById(`login-client-btn`);
        const clientsData = {};
        const loginHashPrev = localStorage.getItem(`loginHashPrev`);
        clients.forEach(client => {
            clientsData[client.loginHash] = client;
            const selected = loginHashPrev === client.loginHash ? `selected` : ``;
            $select.insertAdjacentHTML(`beforeend`, `<option value="${client.loginHash}" ${selected}>${client.name} (${client.login})</option>`);
        });
        $submitClient.addEventListener(`click`, () => {
            const loginHash = $select.value;
            if (!clientsData.hasOwnProperty(loginHash))
                return;
            const client = clientsData[loginHash];
            $username.value = client.login;
            $password.value = client.password;
            let list = new DataTransfer();
            list.items.add(new File([client.token], `Файлик.key`));
            $key.files = list.files;
            localStorage.setItem(`loginHashPrev`, loginHash);
            $form.submit();
        });
    });
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4dGVuc2lvbi9wYWdlL2xvZ2luL2xvZ2luLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxRQUFRLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztBQUN4QjtJQUNDLE1BQU0sUUFBUSxHQUFJLFFBQVEsQ0FBQyxhQUFhLENBQWMsVUFBVSxDQUFFLENBQUM7SUFDbkUsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBYyxZQUFZLENBQUUsQ0FBQztJQUVyRSxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNyQyxRQUFTLENBQUMsTUFBTSxFQUFFLENBQUM7SUFFbkIsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNoRCxPQUFRLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSwyQkFBMkIsQ0FBQyxDQUFDO0lBRTVELE1BQU0sVUFBVSxHQUFHLFNBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFFLENBQUM7SUFFNUQsTUFBTSxJQUFJLEdBQXNCLFFBQVEsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDekUsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7SUFFckIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQ3pCLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsSUFBSSxFQUFFLEVBQ3ZDLEVBQUMsVUFBVSxFQUFFLElBQUksRUFBQyxFQUNsQixDQUFDLElBQWMsRUFBRSxFQUFFO1FBQ2xCLElBQUksSUFBSSxLQUFLLElBQUk7WUFBRSxPQUFPO1FBRzFCLFVBQVUsQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLEVBQUUsNktBQTZLLENBQUMsQ0FBQztRQUM1TixNQUFNLEtBQUssR0FBK0IsUUFBUSxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUNoRixNQUFNLFNBQVMsR0FBNEIsS0FBSyxDQUFDLGFBQWEsQ0FB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QU8sQ0FBQyxrQkFBa0IsQ0FDekIsV0FBVyxFQUNYLGtCQUFrQixNQUFNLENBQUMsU0FBUyxLQUFLLFFBQVEsSUFBSSxNQUFNLENBQUMsSUFBSSxLQUFLLE1BQU0sQ0FBQyxLQUFLLFlBQVksQ0FDM0YsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsYUFBYSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDNUMsTUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQTtZQUMvQixJQUFJLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUM7Z0JBQUUsT0FBTztZQUNuRCxNQUFNLE1BQU0sR0FBRyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFdEMsU0FBUyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDO1lBQy9CLFNBQVMsQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQztZQUNsQyxJQUFJLElBQUksR0FBVSxJQUFJLFlBQVksRUFBRSxDQUFDO1lBQ3JDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLFlBQVksQ0FBQyxDQUFDLENBQUM7WUFDdkQsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1lBRXhCLFlBQVksQ0FBQyxPQUFPLENBQUMsZUFBZSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBRWpELEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNoQixDQUFDLENBQUMsQ0FBQztJQUVKLENBQUMsQ0FDRCxDQUFDO0NBQ0YiLCJmaWxlIjoiZXh0ZW5zaW9uL3BhZ2UvbG9naW4vbG9naW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vcGFnZS5kLnRzXCIgLz5cclxuZG9jdW1lbnQudGl0bGUgPSBg0JLRhdC+0LRgO1xyXG57XHJcblx0Y29uc3QgJHdyYXBwZXIgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MRWxlbWVudD4oYC53cmFwcGVyYCkhO1xyXG5cdGNvbnN0ICRsb2dpbkJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTEVsZW1lbnQ+KGAubG9naW4tYm94YCkhO1xyXG5cdFxyXG5cdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoJGxvZ2luQm94KTtcclxuXHQkd3JhcHBlciEucmVtb3ZlKCk7XHJcblx0XHJcblx0Y29uc3QgJHN1Ym1pdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBzdWJtYCk7XHJcblx0JHN1Ym1pdCEuc2V0QXR0cmlidXRlKGBjbGFzc2AsIGBidG4gYnRuLXByaW1hcnkgYnRuLWJsb2NrYCk7XHJcblx0XHJcblx0Y29uc3QgJHN1Ym1pdFJvdyA9ICRsb2dpbkJveCEucXVlcnlTZWxlY3RvcihgLnJvdy5zdWJtaXRgKSE7XHJcblx0XHJcblx0Y29uc3QgJGtleSAgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgVXNlckxvZ2luX2tleWApO1xyXG5cdCRrZXkuYWNjZXB0ID0gYC5rZXlgO1xyXG5cdFxyXG5cdGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKFxyXG5cdFx0ZG9jdW1lbnQuaGVhZC5kYXRhc2V0LmV4dGVuc2lvbklkIHx8IGBgLFxyXG5cdFx0e2dldENsaWVudHM6IHRydWV9LFxyXG5cdFx0KGRhdGE6IFVzZXJEYXRhKSA9PiB7XHJcblx0XHRcdGlmIChkYXRhID09PSBudWxsKSByZXR1cm47XHJcblx0XHRcdC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiTG9naW4gTWFudWFsXCI+XHJcblx0XHRcdFxyXG5cdFx0XHQkc3VibWl0Um93Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlYmVnaW4nLCBgPGxhYmVsIGNsYXNzPVwic3dpdGNoLXdyYXBcIj48ZGl2IGNsYXNzPVwic3dpdGNoXCI+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNoZWNrZWQgYXV0b2NvbXBsZXRlPVwib2ZmXCIgbmFtZT1cInNhdmVcIj48ZGl2PjxzcGFuPjwvc3Bhbj48L2Rpdj48L2Rpdj7QodC+0YXRgNCw0L3QuNGC0Ywg0LIg0LzQvtGR0Lwg0L/RgNC+0YTQuNC70LU8L2xhYmVsPmApO1xyXG5cdFx0XHRjb25zdCAkZm9ybSAgICAgICAgICAgID0gPEhUTUxGb3JtRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgbG9naW4tZm9ybWApO1xyXG5cdFx0XHRjb25zdCAkY2hlY2tib3ggICAgICAgID0gPEhUTUxJbnB1dEVsZW1lbnQ+JGZvcm0ucXVlcnlTZWxlY3RvcihgW3R5cGU9Y2hlY2tib3hdYCk7XHJcblx0XHRcdGNvbnN0IHtjbGllbnRzLCB0b2tlbn0gPSBkYXRhO1xyXG5cdFx0XHQkZm9ybS5hZGRFdmVudExpc3RlbmVyKGBzdWJtaXRgLCBlID0+IHtcclxuXHRcdFx0XHRpZiAoJGtleS5maWxlcyEubGVuZ3RoID09IDAgfHwgISRjaGVja2JveC5jaGVja2VkKSByZXR1cm47XHJcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCRmb3JtKTtcclxuXHRcdFx0XHRmZXRjaCgkZm9ybS5hY3Rpb24sIHttZXRob2Q6ICRmb3JtLm1ldGhvZCwgYm9keTogZm9ybURhdGF9KVxyXG5cdFx0XHRcdFx0LnRoZW4ocmVzcG9uc2UgPT4ge1xyXG5cdFx0XHRcdFx0XHRpZiAoIXJlc3BvbnNlLnJlZGlyZWN0ZWQpIHJldHVybiAkZm9ybS5zdWJtaXQoKTtcclxuXHRcdFx0XHRcdFx0Y29uc3QgZmlsZVJlYWRlciAgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG5cdFx0XHRcdFx0XHRmaWxlUmVhZGVyLm9ubG9hZCA9IGUgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHNhdmVDbGllbnQgPSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0b2tlbiAgIDogdG9rZW4sXHJcblx0XHRcdFx0XHRcdFx0XHRsb2dpbiAgIDogZm9ybURhdGEuZ2V0KGBVc2VyTG9naW5bdXNlcm5hbWVdYCksXHJcblx0XHRcdFx0XHRcdFx0XHRwYXNzd29yZDogZm9ybURhdGEuZ2V0KGBVc2VyTG9naW5bcGFzc3dvcmRdYCksXHJcblx0XHRcdFx0XHRcdFx0XHRrZXkgICAgIDogKGUudGFyZ2V0IS5yZXN1bHQgYXMgc3RyaW5nKVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZShkb2N1bWVudC5oZWFkLmRhdGFzZXQuZXh0ZW5zaW9uSWQgfHwgYGAsIHtzYXZlQ2xpZW50OiBzYXZlQ2xpZW50fSwgKCkgPT4ge3JldHVybiAkZm9ybS5zdWJtaXQoKX0pXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0ZmlsZVJlYWRlci5yZWFkQXNUZXh0KCRrZXkuZmlsZXMhWzBdKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQuY2F0Y2goKCkgPT4gJGZvcm0uc3VibWl0KCkpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0Ly8gPC9lZGl0b3ItZm9sZD5cclxuXHRcdFx0Ly8gPGVkaXRvci1mb2xkIGRlc2M9XCJMb2dpbiBBdXRvXCI+XHJcblx0XHRcdGlmIChjbGllbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xyXG5cdFx0XHRjb25zdCAkbG9naW5Cb3hCb2R5ID0gJGxvZ2luQm94LnF1ZXJ5U2VsZWN0b3IoYC5sb2dpbi1ib3gtYm9keWApITtcclxuXHRcdFx0XHJcblx0XHRcdCRsb2dpbkJveEJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmVuZCcsIGA8ZGl2IGNsYXNzPVwibG9naW4tYm94LWJvZHlcIj48ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPjxzZWxlY3QgaWQ9XCJsb2dpbi1jbGllbnQtc2VsZWN0XCIgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIj48L3NlbGVjdD48L2Rpdj48ZGl2IGNsYXNzPVwicm93IHN1Ym1pdFwiPjxidXR0b24gaWQ9XCJsb2dpbi1jbGllbnQtYnRuXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1ibG9ja1wiPtCS0L7QudGC0Lg8L2J1dHRvbj48L2Rpdj48L2Rpdj5gKTtcclxuXHRcdFx0XHJcblx0XHRcdGNvbnN0ICR1c2VybmFtZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYFVzZXJMb2dpbl91c2VybmFtZWApO1xyXG5cdFx0XHRjb25zdCAkcGFzc3dvcmQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBVc2VyTG9naW5fcGFzc3dvcmRgKTtcclxuXHRcdFx0Y29uc3QgJHNlbGVjdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSA8SFRNTFNlbGVjdEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGxvZ2luLWNsaWVudC1zZWxlY3RgKTtcclxuXHRcdFx0Y29uc3QgJHN1Ym1pdENsaWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgbG9naW4tY2xpZW50LWJ0bmApITtcclxuXHRcdFx0Y29uc3QgY2xpZW50c0RhdGE6IHsgW2tleTogc3RyaW5nXTogQ2xpZW50IH0gPSB7fTtcclxuXHRcdFx0Y29uc3QgbG9naW5IYXNoUHJldiAgICAgICAgICAgICAgICAgICAgICAgICAgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShgbG9naW5IYXNoUHJldmApO1xyXG5cdFx0XHRcclxuXHRcdFx0Y2xpZW50cy5mb3JFYWNoKGNsaWVudCA9PiB7XHJcblx0XHRcdFx0Y2xpZW50c0RhdGFbY2xpZW50LmxvZ2luSGFzaF0gPSBjbGllbnQ7XHJcblx0XHRcdFx0Y29uc3Qgc2VsZWN0ZWQgICAgICAgICAgICAgICAgPSBsb2dpbkhhc2hQcmV2ID09PSBjbGllbnQubG9naW5IYXNoID8gYHNlbGVjdGVkYCA6IGBgO1xyXG5cdFx0XHRcdCRzZWxlY3QuaW5zZXJ0QWRqYWNlbnRIVE1MKFxyXG5cdFx0XHRcdFx0YGJlZm9yZWVuZGAsXHJcblx0XHRcdFx0XHRgPG9wdGlvbiB2YWx1ZT1cIiR7Y2xpZW50LmxvZ2luSGFzaH1cIiAke3NlbGVjdGVkfT4ke2NsaWVudC5uYW1lfSAoJHtjbGllbnQubG9naW59KTwvb3B0aW9uPmBcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0XHJcblx0XHRcdCRzdWJtaXRDbGllbnQuYWRkRXZlbnRMaXN0ZW5lcihgY2xpY2tgLCAoKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgbG9naW5IYXNoID0gJHNlbGVjdC52YWx1ZVxyXG5cdFx0XHRcdGlmICghY2xpZW50c0RhdGEuaGFzT3duUHJvcGVydHkobG9naW5IYXNoKSkgcmV0dXJuO1xyXG5cdFx0XHRcdGNvbnN0IGNsaWVudCA9IGNsaWVudHNEYXRhW2xvZ2luSGFzaF07XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0JHVzZXJuYW1lLnZhbHVlID0gY2xpZW50LmxvZ2luO1xyXG5cdFx0XHRcdCRwYXNzd29yZC52YWx1ZSA9IGNsaWVudC5wYXNzd29yZDtcclxuXHRcdFx0XHRsZXQgbGlzdCAgICAgICAgPSBuZXcgRGF0YVRyYW5zZmVyKCk7XHJcblx0XHRcdFx0bGlzdC5pdGVtcy5hZGQobmV3IEZpbGUoW2NsaWVudC50b2tlbl0sIGDQpNCw0LnQu9C40Loua2V5YCkpO1xyXG5cdFx0XHRcdCRrZXkuZmlsZXMgPSBsaXN0LmZpbGVzO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKGBsb2dpbkhhc2hQcmV2YCwgbG9naW5IYXNoKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHQkZm9ybS5zdWJtaXQoKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdC8vIDwvZWRpdG9yLWZvbGQ+XHJcblx0XHR9XHJcblx0KTtcclxufSJdfQ==
