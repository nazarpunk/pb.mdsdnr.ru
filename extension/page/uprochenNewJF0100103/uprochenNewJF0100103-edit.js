"use strict";
document.title = `Упрощённый ${document.title}`;
{
    const $form = document.getElementById(`uprochen-new-form`);
    const $submit = $form.querySelector(`.row.buttons input`);
    if ($submit !== null) {
        $submit.removeAttribute(`style`);
        $submit.classList.add(`btn`, `btn-primary`, `btn-block`);
    }
    {
        const $type_decl = document.getElementById(`UprochenNewJF0100103_type_decl`);
        const $type_period = document.getElementById(`UprochenNewJF0100103_type_period`);
        const $month_report = document.getElementById(`UprochenNewJF0100103_month_report`);
        const $row1 = document.getElementById(`UprochenNewJF0100103_row1`);
        const $view1 = document.getElementById(`view1`);
        $view1.querySelectorAll(`:scope > *`).forEach($elem => $view1.append($elem));
        $view1.querySelectorAll(`[type=text], select`).forEach($input => {
            $input.classList.add(`form-control`);
            $input.removeAttribute(`style`);
        });
        const $row2 = document.getElementById(`UprochenNewJF0100103_row2`);
        $row2.closest(`tr`).insertAdjacentHTML(`beforebegin`, `<tr><td></td><td id="saldo-row2-td-1" class="text-right"></td><td id="saldo-row2-td-2"></td></tr>`);
        const $row2_td1 = document.getElementById(`saldo-row2-td-1`);
        const $row2_td2 = document.getElementById(`saldo-row2-td-2`);
        $row2_td2.addEventListener(`click`, e => {
            const $btn = e.target.closest(`button`);
            if ($btn !== null)
                $row1.value = $btn.innerText;
        });
        $row2.readOnly = true;
        $row2.removeAttribute(`onkeyup`);
        $row2.addEventListener(`input`, () => {
            if (!$row2.readOnly)
                return;
            const row2 = parseInt($row2_1.value) + parseInt($row2_2.value) - parseInt($row2_3.value);
            if (isNaN(row2))
                return;
            $row2.value = row2.toString();
            $row2_td1.innerHTML = ``;
            $row2_td2.innerHTML = ``;
            if ((+$type_decl.value !== 1 && +$type_decl.value !== 2) || +$type_period.value !== 1)
                return;
            const month = parseInt($month_report.value);
            let row1 = parseInt($row1.value);
            if (isNaN(month) || isNaN(row1))
                return;
            if (month === 1)
                row1 = 0;
            $row2_td1.innerHTML = `Новая сумма за год: <b>${row1}</b> + <b>${row2}</b> = &nbsp;`;
            $row2_td2.innerHTML = `<button type="button" class="btn btn-primary btn-sm btn-block">${row1 + row2}</button>`;
            window.decl1($form);
        });
        $type_decl.addEventListener(`change`, () => $row2.dispatchEvent(new InputEvent(`input`)));
        $type_period.addEventListener(`change`, () => $row2.dispatchEvent(new InputEvent(`input`)));
        $month_report.addEventListener(`change`, () => $row2.dispatchEvent(new InputEvent(`input`)));
        const $row2_1 = document.getElementById(`UprochenNewJF0100103_row2_1`);
        const $row2_2 = document.getElementById(`UprochenNewJF0100103_row2_2`);
        const $row2_3 = document.getElementById(`UprochenNewJF0100103_row2_3`);
        [$row2_1, $row2_2, $row2_3].forEach($row => {
            $row.removeAttribute(`onkeyup`);
            $row.addEventListener(`input`, () => $row2.dispatchEvent(new InputEvent(`input`)));
        });
        [`UprochenNewJF0100103_row4`, `UprochenNewJF0100103_row5`].forEach(id => {
            const $select = document.getElementById(id);
            if ($select === null)
                return;
            $select.insertAdjacentHTML(`beforebegin`, `<div class="input-group"><span class="input-group-addon">%</span>`);
            $select.nextElementSibling.remove();
            $select.previousElementSibling.insertAdjacentElement(`afterbegin`, $select);
        });
        const $manually = $view1.querySelector(`[onclick='EditAll()']`);
        if ($manually !== null) {
            $manually.classList.add(`btn`, `btn-default`);
            $manually.removeAttribute(`onclick`);
            $manually.addEventListener(`click`, () => {
                if (!confirm(`Отключить ручное редактирование возможно только после обновления страницы. Продолжить?`))
                    return;
                $manually.insertAdjacentHTML(`afterend`, `<div class="alert alert-warning">Включено ручное редактирование!</div>`);
                $row2.readOnly = false;
                $manually.remove();
                window.EditAll();
            });
        }
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4dGVuc2lvbi9wYWdlL3Vwcm9jaGVuTmV3SkYwMTAwMTAzL3Vwcm9jaGVuTmV3SkYwMTAwMTAzLWVkaXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLFFBQVEsQ0FBQyxLQUFLLEdBQUcsY0FBYyxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7QUFDaEQ7SUFDQyxNQUFNLEtBQUssR0FBSyxRQUFRLENBQUMsY0FBYyxDQUFDLG1CQUFtQixDQUFFLENBQUM7SUFDOUQsTUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQzFELElBQUksT0FBTyxLQUFLLElBQUksRUFBRTtRQUNyQixPQUFPLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2pDLE9BQU8sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxhQUFhLEVBQUUsV0FBVyxDQUFDLENBQUM7S0FDekQ7SUFHRDtRQUNDLE1BQU0sVUFBVSxHQUF5QixRQUFRLENBQUMsY0FBYyxDQUFDLGdDQUFnQyxDQUFFLENBQUM7UUFDcEcsTUFBTSxZQUFZLEdBQXVCLFFBQVEsQ0FBQyxjQUFjLENBQUMsa0NBQWtDLENBQUUsQ0FBQztRQUN0RyxNQUFNLGFBQWEsR0FBc0IsUUFBUSxDQUFDLGNBQWMsQ0FBQyxtQ0FBbUMsQ0FBRSxDQUFDO1FBQ3ZHLE1BQU0sS0FBSyxHQUE2QixRQUFRLENBQUMsY0FBYyxDQUFDLDJCQUEyQixDQUFFLENBQUM7UUFDOUYsTUFBTSxNQUFNLEdBQVUsUUFBUSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUUsQ0FBQztRQUN4RCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzdFLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLE9BQU8s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QztRQUdILE1BQU0sU0FBUyxHQUFHLE1BQU0sQ0FBQyxhQUFhLENBQUMsdUJBQXVCLENBQUMsQ0FBQztRQUNoRSxJQUFJLFNBQVMsS0FBSyxJQUFJLEVBQUU7WUFDdkIsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLGFBQWEsQ0FBQyxDQUFDO1lBQzlDLFNBQVMsQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDckMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7Z0JBQ3hDLElBQUksQ0FBQyxPQUFPLENBQUMsd0ZBQXdGLENBQUM7b0JBQUUsT0FBTztnQkFDL0csU0FBUyxDQUFDLGtCQUFrQixDQUFDLFVBQVUsRUFBRSx3RUFBd0UsQ0FBQyxDQUFDO2dCQUNuSCxLQUFLLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztnQkFDdkIsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUVuQixNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDbEIsQ0FBQyxDQUFDLENBQUM7U0FDSDtLQUNEO0NBRUQiLCJmaWxlIjoiZXh0ZW5zaW9uL3BhZ2UvdXByb2NoZW5OZXdKRjAxMDAxMDMvdXByb2NoZW5OZXdKRjAxMDAxMDMtZWRpdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9wYWdlLmQudHNcIiAvPlxyXG5kb2N1bWVudC50aXRsZSA9IGDQo9C/0YDQvtGJ0ZHQvdC90YvQuSAke2RvY3VtZW50LnRpdGxlfWA7XHJcbntcclxuXHRjb25zdCAkZm9ybSAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHVwcm9jaGVuLW5ldy1mb3JtYCkhO1xyXG5cdGNvbnN0ICRzdWJtaXQgPSAkZm9ybS5xdWVyeVNlbGVjdG9yKGAucm93LmJ1dHRvbnMgaW5wdXRgKTtcclxuXHRpZiAoJHN1Ym1pdCAhPT0gbnVsbCkge1xyXG5cdFx0JHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoYHN0eWxlYCk7XHJcblx0XHQkc3VibWl0LmNsYXNzTGlzdC5hZGQoYGJ0bmAsIGBidG4tcHJpbWFyeWAsIGBidG4tYmxvY2tgKTtcclxuXHR9XHJcblx0XHJcblx0Ly88ZWRpdG9yLWZvbGQgZGVzYz1cInZpZXcgMVwiPlxyXG5cdHtcclxuXHRcdGNvbnN0ICR0eXBlX2RlY2wgICAgPSA8SFRNTFNlbGVjdEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYFVwcm9jaGVuTmV3SkYwMTAwMTAzX3R5cGVfZGVjbGApITtcclxuXHRcdGNvbnN0ICR0eXBlX3BlcmlvZCAgPSA8SFRNTFNlbGVjdEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYFVwcm9jaGVuTmV3SkYwMTAwMTAzX3R5cGVfcGVyaW9kYCkhO1xyXG5cdFx0Y29uc3QgJG1vbnRoX3JlcG9ydCA9IDxIVE1MU2VsZWN0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgVXByb2NoZW5OZXdKRjAxMDAxMDNfbW9udGhfcmVwb3J0YCkhO1xyXG5cdFx0Y29uc3QgJHJvdzEgICAgICAgICA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBVcHJvY2hlbk5ld0pGMDEwMDEwM19yb3cxYCkhO1xyXG5cdFx0Y29uc3QgJHZpZXcxICAgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGB2aWV3MWApITtcclxuXHRcdCR2aWV3MS5xdWVyeVNlbGVjdG9yQWxsKGA6c2NvcGUgPiAqYCkuZm9yRWFjaCgkZWxlbSA9PiAkdmlldzEuYXBwZW5kKCRlbGVtKSk7XHJcblx0XHQkdmlldzEucXVlcnlTZWxlY3RvckFsbChgW3R5cGU9dGV4dF0sIHNlbGVjdGApLmZvckVhY2goJGlucHV0ID0+IHtcclxuXHRcdFx0JGlucHV0LmNsYXNzTGlzdC5hZGQoYGZvcm0tY29udHJvbGApO1xyXG5cdFx0XHQkaW5wdXQucmVtb3ZlQXR0cmlidXRlKGBzdHlsZWApO1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHRcdGNvbnN0ICRyb3cyID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYFVwcm9jaGVuTmV3SkYwMTAwMTAzX3JvdzJgKSE7XHJcblx0XHQkcm93Mi5jbG9zZXN0PEhUTUxFbGVtZW50PihgdHJgKSEuaW5zZXJ0QWRqYWNlbnRIVE1MKGBiZWZvcmViZWdpbmAsIGA8dHI+PHRkPjwvdGQ+PHRkIGlkPVwic2FsZG8tcm93Mi10ZC0xXCIgY2xhc3M9XCJ0ZXh0LXJpZ2h0XCI+PC90ZD48dGQgaWQ9XCJzYWxkby1yb3cyLXRkLTJcIj48L3RkPjwvdHI+YCk7XHJcblx0XHRjb25zdCAkcm93Ml90ZDEgPSA8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHNhbGRvLXJvdzItdGQtMWApITtcclxuXHRcdGNvbnN0ICRyb3cyX3RkMiA9IDxIVE1MRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgc2FsZG8tcm93Mi10ZC0yYCkhO1xyXG5cdFx0JHJvdzJfdGQyLmFkZEV2ZW50TGlzdGVuZXIoYGNsaWNrYCwgZSA9PiB7XHJcblx0XHRcdGNvbnN0ICRidG4gPSAoPEhUTUxFbGVtZW50PmUudGFyZ2V0KS5jbG9zZXN0KGBidXR0b25gKTtcclxuXHRcdFx0aWYgKCRidG4gIT09IG51bGwpICRyb3cxLnZhbHVlID0gJGJ0bi5pbm5lclRleHQ7XHJcblx0XHR9KTtcclxuXHRcdCRyb3cyLnJlYWRPbmx5ID0gdHJ1ZTtcclxuXHRcdCRyb3cyLnJlbW92ZUF0dHJpYnV0ZShgb25rZXl1cGApO1xyXG5cdFx0JHJvdzIuYWRkRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCAoKSA9PiB7XHJcblx0XHRcdGlmICghJHJvdzIucmVhZE9ubHkpIHJldHVybjtcclxuXHRcdFx0Y29uc3Qgcm93MiA9IHBhcnNlSW50KCRyb3cyXzEudmFsdWUpICsgcGFyc2VJbnQoJHJvdzJfMi52YWx1ZSkgLSBwYXJzZUludCgkcm93Ml8zLnZhbHVlKTtcclxuXHRcdFx0aWYgKGlzTmFOKHJvdzIpKSByZXR1cm47XHJcblx0XHRcdCRyb3cyLnZhbHVlID0gcm93Mi50b1N0cmluZygpO1xyXG5cdFx0XHRcclxuXHRcdFx0JHJvdzJfdGQxLmlubmVySFRNTCA9IGBgO1xyXG5cdFx0XHQkcm93Ml90ZDIuaW5uZXJIVE1MID0gYGA7XHJcblx0XHRcdGlmICgoKyR0eXBlX2RlY2wudmFsdWUgIT09IDEgJiYgKyR0eXBlX2RlY2wudmFsdWUgIT09IDIpIHx8ICskdHlwZV9wZXJpb2QudmFsdWUgIT09IDEpIHJldHVybjtcclxuXHRcdFx0Y29uc3QgbW9udGggPSBwYXJzZUludCgkbW9udGhfcmVwb3J0LnZhbHVlKTtcclxuXHRcdFx0bGV0IHJvdzEgICAgPSBwYXJzZUludCgkcm93MS52YWx1ZSk7XHJcblx0XHRcdGlmIChpc05hTihtb250aCkgfHwgaXNOYU4ocm93MSkpIHJldHVybjtcclxuXHRcdFx0aWYgKG1vbnRoID09PSAxKSByb3cxID0gMDtcclxuXHRcdFx0JHJvdzJfdGQxLmlubmVySFRNTCA9IGDQndC+0LLQsNGPINGB0YPQvNC80LAg0LfQsCDQs9C+0LQ6IDxiPiR7cm93MX08L2I+ICsgPGI+JHtyb3cyfTwvYj4gPSAmbmJzcDtgO1xyXG5cdFx0XHQkcm93Ml90ZDIuaW5uZXJIVE1MID0gYDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1zbSBidG4tYmxvY2tcIj4ke3JvdzEgKyByb3cyfTwvYnV0dG9uPmA7XHJcblx0XHRcdC8vQHRzLWlnbm9yZVxyXG5cdFx0XHR3aW5kb3cuZGVjbDEoJGZvcm0pO1xyXG5cdFx0fSk7XHJcblx0XHQkdHlwZV9kZWNsLmFkZEV2ZW50TGlzdGVuZXIoYGNoYW5nZWAsICgpID0+ICRyb3cyLmRpc3BhdGNoRXZlbnQobmV3IElucHV0RXZlbnQoYGlucHV0YCkpKTtcclxuXHRcdCR0eXBlX3BlcmlvZC5hZGRFdmVudExpc3RlbmVyKGBjaGFuZ2VgLCAoKSA9PiAkcm93Mi5kaXNwYXRjaEV2ZW50KG5ldyBJbnB1dEV2ZW50KGBpbnB1dGApKSk7XHJcblx0XHQkbW9udGhfcmVwb3J0LmFkZEV2ZW50TGlzdGVuZXIoYGNoYW5nZWAsICgpID0+ICRyb3cyLmRpc3BhdGNoRXZlbnQobmV3IElucHV0RXZlbnQoYGlucHV0YCkpKTtcclxuXHRcdFxyXG5cdFx0Y29uc3QgJHJvdzJfMSA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBVcHJvY2hlbk5ld0pGMDEwMDEwM19yb3cyXzFgKSE7XHJcblx0XHRjb25zdCAkcm93Ml8yID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYFVwcm9jaGVuTmV3SkYwMTAwMTAzX3JvdzJfMmApITtcclxuXHRcdGNvbnN0ICRyb3cyXzMgPSA8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgVXByb2NoZW5OZXdKRjAxMDAxMDNfcm93Ml8zYCkhO1xyXG5cdFx0WyRyb3cyXzEsICRyb3cyXzIsICRyb3cyXzNdLmZvckVhY2goJHJvdyA9PiB7XHJcblx0XHRcdCRyb3cucmVtb3ZlQXR0cmlidXRlKGBvbmtleXVwYCk7XHJcblx0XHRcdCRyb3cuYWRkRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCAoKSA9PiAkcm93Mi5kaXNwYXRjaEV2ZW50KG5ldyBJbnB1dEV2ZW50KGBpbnB1dGApKSk7XHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0W2BVcHJvY2hlbk5ld0pGMDEwMDEwM19yb3c0YCwgYFVwcm9jaGVuTmV3SkYwMTAwMTAzX3JvdzVgXS5mb3JFYWNoKGlkID0+IHtcclxuXHRcdFx0Y29uc3QgJHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuXHRcdFx0aWYgKCRzZWxlY3QgPT09IG51bGwpIHJldHVybjtcclxuXHRcdFx0JHNlbGVjdC5pbnNlcnRBZGphY2VudEhUTUwoYGJlZm9yZWJlZ2luYCwgYDxkaXYgY2xhc3M9XCJpbnB1dC1ncm91cFwiPjxzcGFuIGNsYXNzPVwiaW5wdXQtZ3JvdXAtYWRkb25cIj4lPC9zcGFuPmApO1xyXG5cdFx0XHQkc2VsZWN0Lm5leHRFbGVtZW50U2libGluZyEucmVtb3ZlKCk7XHJcblx0XHRcdCRzZWxlY3QucHJldmlvdXNFbGVtZW50U2libGluZyEuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KGBhZnRlcmJlZ2luYCwgJHNlbGVjdCk7XHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0Ly8gbWFudWFsbHlcclxuXHRcdGNvbnN0ICRtYW51YWxseSA9ICR2aWV3MS5xdWVyeVNlbGVjdG9yKGBbb25jbGljaz0nRWRpdEFsbCgpJ11gKTtcclxuXHRcdGlmICgkbWFudWFsbHkgIT09IG51bGwpIHtcclxuXHRcdFx0JG1hbnVhbGx5LmNsYXNzTGlzdC5hZGQoYGJ0bmAsIGBidG4tZGVmYXVsdGApO1xyXG5cdFx0XHQkbWFudWFsbHkucmVtb3ZlQXR0cmlidXRlKGBvbmNsaWNrYCk7XHJcblx0XHRcdCRtYW51YWxseS5hZGRFdmVudExpc3RlbmVyKGBjbGlja2AsICgpID0+IHtcclxuXHRcdFx0XHRpZiAoIWNvbmZpcm0oYNCe0YLQutC70Y7Rh9C40YLRjCDRgNGD0YfQvdC+0LUg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjQtSDQstC+0LfQvNC+0LbQvdC+INGC0L7Qu9GM0LrQviDQv9C+0YHQu9C1INC+0LHQvdC+0LLQu9C10L3QuNGPINGB0YLRgNCw0L3QuNGG0YsuINCf0YDQvtC00L7Qu9C20LjRgtGMP2ApKSByZXR1cm47XHJcblx0XHRcdFx0JG1hbnVhbGx5Lmluc2VydEFkamFjZW50SFRNTChgYWZ0ZXJlbmRgLCBgPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LXdhcm5pbmdcIj7QktC60LvRjtGH0LXQvdC+INGA0YPRh9C90L7QtSDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC1ITwvZGl2PmApO1xyXG5cdFx0XHRcdCRyb3cyLnJlYWRPbmx5ID0gZmFsc2U7XHJcblx0XHRcdFx0JG1hbnVhbGx5LnJlbW92ZSgpO1xyXG5cdFx0XHRcdC8vQHRzLWlnbm9yZTtcclxuXHRcdFx0XHR3aW5kb3cuRWRpdEFsbCgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcblx0Ly88L2VkaXRvci1mb2xkPlxyXG59Il19
